<!DOCTYPE html>
<html lang="zh-Hant">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>è¡¨å–®ç´€éŒ„åˆ—è¡¨</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <!-- å¼•å…¥ SheetJS -->
        <script
            src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    </head>
    <body class="bg-gray-100 min-h-screen p-6">
        <button href="report.html" id="export-btn"
            class="fixed bottom-16 right-4 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-full shadow-lg transition">
            ğŸ“¤ è¼¸å‡ºå ±è¡¨
        </button>
        <a href="index.html"
            class="fixed bottom-4 right-4 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-full shadow-lg transition">
            ğŸ“„ ç¹¼çºŒæ·»åŠ 
        </a>
        <div class="max-w-4xl mx-auto bg-white shadow-lg rounded-xl p-6">
            <h1 class="text-2xl font-bold mb-6 text-center">ğŸ“‹ è¡¨å–®ç´€éŒ„æ¸…å–®</h1>

            <div class="overflow-x-auto">
                <table
                    class="min-w-full border text-sm text-left text-gray-600">
                    <thead class="bg-gray-200 text-gray-700 uppercase text-xs">
                        <tr>
                            <th class="px-4 py-3">å¡«è¡¨äºº</th>
                            <th class="px-4 py-3">æ•¸é‡</th>
                            <th class="px-4 py-3">æƒæè³‡æ–™</th>
                            <th class="px-4 py-3 text-center">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody id="table-body"
                        class="bg-white divide-y divide-gray-200">
                        <!-- JS å‹•æ…‹æ’å…¥ -->
                    </tbody>
                </table>
            </div>
        </div>

        <script>
    const tableBody = document.getElementById("table-body");

    // å–å¾— localStorage è³‡æ–™
    let data = JSON.parse(localStorage.getItem("formDataList")) || [];

    function renderTable() {
      tableBody.innerHTML = ""; // å…ˆæ¸…ç©º
      if (data.length === 0) {
        tableBody.innerHTML = `<tr><td colspan="4" class="text-center py-4 text-gray-500">æ²’æœ‰ä»»ä½•è³‡æ–™</td></tr>`;
        return;
      }

      data.forEach((entry, index) => {
        const row = document.createElement("tr");
        row.classList.add("hover:bg-gray-100");

        row.innerHTML = `
          <td class="px-4 py-3">${entry.å¡«è¡¨äºº}</td>
          <td class="px-4 py-3">${entry.æ•¸é‡}</td>
          <td class="px-4 py-3">${entry.æƒæè³‡æ–™}</td>
          <td class="px-4 py-3 text-center">
            <button class="text-red-600 hover:underline" onclick="deleteEntry(${index})">åˆªé™¤</button>
          </td>
        `;
        tableBody.appendChild(row);
      });
    }

    function deleteEntry(index) {
      if (confirm("ç¢ºå®šè¦åˆªé™¤é€™ç­†è³‡æ–™å—ï¼Ÿ")) {
        data.splice(index, 1);
        localStorage.setItem("formDataList", JSON.stringify(data));
        renderTable();
      }
    }

    renderTable();
  </script>
        <script>
    document.getElementById("export-btn").addEventListener("click", () => {
      // å¾ localStorage å–è³‡æ–™
      const data = JSON.parse(localStorage.getItem("formDataList")) || [];
      if (data.length === 0) {
        alert("ç›®å‰æ²’æœ‰è³‡æ–™å¯åŒ¯å‡ºï¼");
        return;
      }

      // è½‰æˆ SheetJS æ”¯æ´çš„æ ¼å¼ (é™£åˆ— of ç‰©ä»¶)
      // data æœ¬èº«å·²ç¶“æ˜¯é€™ç¨®æ ¼å¼ï¼Œç›´æ¥ç”¨å³å¯

      // å»ºç«‹å·¥ä½œç°¿å’Œå·¥ä½œè¡¨
      const ws = XLSX.utils.json_to_sheet(data);
      const wb = XLSX.utils.book_new();
      XLSX.utils.book_append_sheet(wb, ws, "å ±è¡¨");

      // ç”¢ç”Ÿ Excel æª”æ¡ˆä¸¦è§¸ç™¼ä¸‹è¼‰
      XLSX.writeFile(wb, "å ±è¡¨.xlsx");
    });
  </script>

    </body>
</html>
